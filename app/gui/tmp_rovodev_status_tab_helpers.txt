Add to MainWindow class:

    def _on_tab_changed(self, idx: int):
        # Refresh and update status for the active tab only
        try:
            label = self.tabs.tabText(idx)
        except Exception:
            label = ""
        if label == "Library":
            self._refresh_library()
        elif label == "Duplicates":
            self._refresh_duplicates()
        elif label == "Junk":
            # update junk status when switching
            try:
                self._update_junk_status()
            except Exception:
                pass
        # Unknown Types doesn't need periodic refresh

    def _update_library_status(self):
        try:
            from ..db import fetch_library_rows
            rows = fetch_library_rows(self.conn)
            count = len(rows)
            total = sum(int(r[1] or 0) for r in rows)  # r[1] is size
            self._set_status_info(f"Library: {count} files | Total size: {self._human_size(total)}")
        except Exception:
            pass

    def _update_duplicates_status(self, rows=None):
        if rows is None:
            try:
                from ..db import fetch_duplicate_rows
                rows = fetch_duplicate_rows(self.conn, include_suspected=True)
            except Exception:
                rows = []
        from collections import defaultdict
        groups = defaultdict(list)
        for r in rows:
            groups[r[0]].append(r)
        total_wasted = 0
        dup_files = 0
        for g, items in groups.items():
            if len(items) > 1:
                dup_files += len(items)
                size = int(items[0][2] or 0)
                total_wasted += size * (len(items)-1)
        self._set_status_info(f"Duplicates: {dup_files} files | Wasted: {self._human_size(total_wasted)}")

    def _update_junk_status(self):
        try:
            from ..db import list_junk
            rows = list_junk(self.conn)
            count = len(rows)
            total = sum(int(r[1] or 0) for r in rows)
            self._set_status_info(f"Junk: {count} files | Total size: {self._human_size(total)}")
        except Exception:
            pass

    def _human_size(self, n):
        try:
            n = int(n or 0)
        except Exception:
            return "0 B"
        units = ['B','KB','MB','GB','TB','PB']
        i = 0; f = float(n)
        while f >= 1024 and i < len(units)-1:
            f /= 1024.0; i += 1
        return f"{f:.1f} {units[i]}" if n else "0 B"

    def _set_status_info(self, text: str):
        try:
            if not hasattr(self, '_status_info'):
                self._status_info = QtWidgets.QLabel()
                self.status.insertWidget(0, self._status_info, 1)
            self._status_info.setText(text)
        except Exception:
            pass
